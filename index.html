<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Worker Onboarding</title>

<style>
body { font-family: Arial; background:#f2f2f2; }
.box {
  max-width:480px;
  background:#fff;
  margin:20px auto;
  padding:20px;
  border-radius:6px;
}
input, select, button {
  width:100%;
  padding:10px;
  margin-top:8px;
}
button {
  background:#1a73e8;
  color:#fff;
  border:none;
  font-size:16px;
}
button:disabled { background:#999; }
</style>
</head>

<body>
<div class="box">
<h3>Worker Onboarding</h3>

<form id="form">
<input id="name" placeholder="Full Name" required>
<input type="date" id="dob" required>

<select id="gender">
<option>Male</option>
<option>Female</option>
</select>

<input id="designation" placeholder="Designation">
<input id="father" placeholder="Father Name">
<input id="contact" placeholder="Contact No">

<input id="emgName" placeholder="Emergency Contact Name">
<input id="emgRel" placeholder="Relation">
<input id="emgContact" placeholder="Emergency Contact No">

<input id="state" placeholder="State">
<input id="workLocation" placeholder="Work Location">

<input id="bank" placeholder="Bank Name">
<input id="account" placeholder="Account No">
<input id="ifsc" placeholder="IFSC">

<input id="uan" placeholder="UAN No">
<input id="esi" placeholder="ESI / WC Policy">
<input id="aadhaar" placeholder="Aadhaar No">
<input id="pan" placeholder="PAN No">

<input id="education" placeholder="Education">
<input id="experience" placeholder="Scaffolding Experience">

<label>Aadhaar Front</label>
<input type="file" id="af">

<label>Aadhaar Back</label>
<input type="file" id="ab">

<label>Bank Passbook</label>
<input type="file" id="bp">

<label>Passport Photo</label>
<input type="file" id="photo">

<button id="submit">Submit</button>
</form>
</div>

<script>
const WEB_APP_URL =
"https://script.google.com/macros/s/AKfycbwoUO7cyEColEfR55Ey0xry85eOACl3knYpewwceRYEKdcqjxqIsaTfxAfEg0JTSTXX/exec";

function toBase64(file) {
  return new Promise(resolve => {
    if (!file) return resolve("");
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result);
    reader.readAsDataURL(file);
  });
}

document.getElementById("form").addEventListener("submit", async e => {
  e.preventDefault();
  const btn = document.getElementById("submit");
  btn.disabled = true;

  const data = {
    name: name.value,
    dob: dob.value,
    gender: gender.value,
    designation: designation.value,
    father: father.value,
    contact: contact.value,
    emgName: emgName.value,
    emgRel: emgRel.value,
    emgContact: emgContact.value,
    state: state.value,
    workLocation: workLocation.value,
    bank: bank.value,
    account: account.value,
    ifsc: ifsc.value,
    uan: uan.value,
    esi: esi.value,
    aadhaar: aadhaar.value,
    pan: pan.value,
    education: education.value,
    experience: experience.value,
    af: await toBase64(af.files[0]),
    ab: await toBase64(ab.files[0]),
    bp: await toBase64(bp.files[0]),
    photo: await toBase64(photo.files[0])
  };

  const res = await fetch(WEB_APP_URL, {
    method: "POST",
    body: JSON.stringify(data)
  });

  const text = await res.text();
  if (text === "SUCCESS") {
    alert("Submitted Successfully");
    btn.style.display = "none";
    window.print();
  } else {
    alert(text);
    btn.disabled = false;
  }
});
</script>
</body>
</html>
